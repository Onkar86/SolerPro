import{r as a,V as o,j as e}from"./index-DkCumAEg.js";import{c as I}from"./index-BZ0pF2jg.js";import{S as h,B as p}from"./Section-Bqk7GYGe.js";import{C as f}from"./Card-naoiKXdQ.js";import{D as k,T as S}from"./trash-2-DgFh-4TI.js";const c=I("https://gavftmfxkjkpshcvhnjt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdhdmZ0bWZ4a2prcHNoY3Zobmp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUzMjI2NjgsImV4cCI6MjA2MDg5ODY2OH0.Jvvxi1bFflXS1Ks2_CcmefXFUS6eMynygr7GvMce3dY");function J(){const[g,i]=a.useState(!1),[d,j]=a.useState([]),[y,m]=a.useState(!0),[l,x]=a.useState({username:"",password:""});a.useEffect(()=>{localStorage.getItem("isAdmin")==="true"?(i(!0),n()):m(!1)},[]);const n=async()=>{try{const{data:t,error:s}=await c.storage.from("uploads").list();if(s)throw s;j(t||[])}catch(t){console.error("Error fetching files:",t),o.error("Failed to fetch files")}finally{m(!1)}},b=t=>{t.preventDefault(),l.username==="admin"&&l.password==="onkar@123"?(localStorage.setItem("isAdmin","true"),i(!0),n()):o.error("Invalid credentials")},w=async t=>{try{const{data:s,error:u}=await c.storage.from("uploads").download(t);if(u)throw u;const N=window.URL.createObjectURL(s),r=document.createElement("a");r.href=N,r.download=t,document.body.appendChild(r),r.click(),r.remove()}catch(s){console.error("Download error:",s),o.error("Failed to download file")}},v=async t=>{if(confirm("Are you sure you want to delete this file?"))try{const{error:s}=await c.storage.from("uploads").remove([t]);if(s)throw s;o.success("File deleted successfully"),n()}catch(s){console.error("Delete error:",s),o.error("Failed to delete file")}};return y?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):g?e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx(h,{children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Uploaded Files"}),e.jsx(p,{variant:"outline",onClick:()=>{localStorage.removeItem("isAdmin"),i(!1)},children:"Logout"})]}),e.jsx(f,{className:"overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"File Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Upload Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-6 py-4 text-center text-gray-500",children:"No files uploaded yet"})}):d.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.created_at).toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>w(t.name),className:"text-blue-600 hover:text-blue-900 mr-4",children:e.jsx(k,{size:18})}),e.jsx("button",{onClick:()=>v(t.name),className:"text-red-600 hover:text-red-900",children:e.jsx(S,{size:18})})]})]},t.id))})]})})})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx(h,{children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(f,{className:"p-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Admin Login"}),e.jsx("form",{onSubmit:b,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),e.jsx("input",{type:"text",value:l.username,onChange:t=>x(s=>({...s,username:t.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("input",{type:"password",value:l.password,onChange:t=>x(s=>({...s,password:t.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0})]}),e.jsx(p,{type:"submit",fullWidth:!0,children:"Login"})]})})]})})})})}export{J as default};
